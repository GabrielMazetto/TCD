{"id_funcao": "exploracao_e_limpeza_de_dados.remove_rows_all_zeros_except.0_1_0", "titulo": "remove_rows_all_zeros_except", "categoria": "Exploração e Limpeza de Dados", "subcategoria": "Tratamento de Dados Inválidos", "descricao": "Breve Descrição", "codigo_funcao": "def remove_rows_all_zeros_except(\n    df: pd.DataFrame,\n    cols_to_ignore: Optional[List[str]] = None,\n    inplace: bool = False\n) -> Optional[pd.DataFrame]:\n    \"\"\"\n    Remove linhas de um DataFrame onde todas as colunas, exceto as especificadas, são zero.\n\n    Esta função identifica e remove linhas que são preenchidas majoritariamente por zeros,\n    o que geralmente indica dados inválidos ou de preenchimento. É útil para limpar\n    datasets após importações ou junções que podem gerar registros vazios.\n\n    Args:\n        df (pd.DataFrame): O DataFrame de entrada a ser processado.\n        cols_to_ignore (List[str], optional): Lista de nomes de colunas a serem\n            ignoradas na verificação de zeros. Por padrão, nenhuma coluna é ignorada.\n        inplace (bool, optional): Se True, a modificação é feita no DataFrame\n            original e a função retorna None. Se False (padrão), retorna um novo\n            DataFrame com as linhas removidas.\n\n    Returns:\n        pd.DataFrame or None: Um novo DataFrame com as linhas removidas ou None se\n            inplace=True.\n    \"\"\"\n    if not isinstance(df, pd.DataFrame):\n        raise TypeError(\"O argumento 'df' deve ser um DataFrame do pandas.\")\n\n    df_copy = df if inplace else df.copy()\n\n    cols_to_check = df_copy.columns\n    if cols_to_ignore:\n        # Valida se as colunas a ignorar existem\n        non_existent_cols = [col for col in cols_to_ignore if col not in df_copy.columns]\n        if non_existent_cols:\n            raise ValueError(f\"As seguintes colunas não existem no DataFrame: {non_existent_cols}\")\n        cols_to_check = df_copy.columns.drop(cols_to_ignore)\n\n    # Máscara para identificar linhas onde todas as colunas a verificar são zero\n    zero_mask = (df_copy[cols_to_check] == 0).all(axis=1)\n\n    rows_to_drop = df_copy[zero_mask].index\n    df_copy.drop(rows_to_drop, inplace=True)\n\n    if inplace:\n        return None\n    else:\n        return df_copy\n", "bibliotecas": ["pandas", "numpy"], "versao": "0.1.0"}
